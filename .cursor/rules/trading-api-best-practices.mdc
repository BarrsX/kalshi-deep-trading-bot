---
globs: "*.py"
description: "Trading bot specific API documentation and best practices"
---

# Trading Bot API Documentation Best Practices

## Financial API Documentation Priority

For this trading bot project, **always consult official documentation** for:

### Kalshi API
- Authentication patterns (RSA signatures, headers)
- Market data structures and response formats
- Order placement and position management
- Event and market filtering parameters
- Rate limiting and error handling

### Perplexity API (Research + Structured Output)
- Request/response formats for Sonar models
- Real-time search and recency filtering
- JSON extraction from model responses
- Rate limiting and timeout handling

## Critical Areas Requiring Documentation Lookup

### 1. Market Data Formats
- **Always verify** market close times, status fields, and data structures
- Check for API changes in market filtering and event querying
- Confirm volume, liquidity, and pricing field formats

### 2. Authentication & Security
- Look up current authentication patterns for each API
- Verify signature generation and header formatting
- Check for security best practices and token management

### 3. Error Handling
- Research specific error codes and their meanings
- Look up recommended retry strategies
- Verify timeout and rate limiting parameters

## Example Implementation Pattern

```python
# ✅ Good: Parse JSON from Perplexity response with proper extraction
response = await client.post(url, json=request_body)
content = response.json()["choices"][0]["message"]["content"]
json_data = extract_json_from_text(content)  # Handle <think> blocks, markdown

# ❌ Bad: Assume clean JSON response
data = json.loads(response.json()["choices"][0]["message"]["content"])
```

## Project-Specific References

Always reference these official sources:
- [Kalshi API Documentation](https://docs.kalshi.com/)
- [Perplexity API Documentation](https://docs.perplexity.ai/)

## Risk Considerations

Financial trading APIs change frequently. **Never assume** that:
- Market data formats remain constant
- Authentication patterns are unchanged
- Error handling approaches are still valid
- Rate limits and timeouts are the same

When in doubt, search for the current documentation rather than relying on examples or memory.
